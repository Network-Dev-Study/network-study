# 네트워크 계층 개요

![Untitled](https://user-images.githubusercontent.com/76640167/212541870-2c4951cb-167a-48f2-a69d-b6dc44c6d656.png)

각 라우터의 데이터 평면 역할은 입력 링크에서 출력 링크로 데이터그램을 전달하는 것이다.

네트워크 제어 평면의 근본적인 역할은 데이터그램이 출발지 호스트에서 목적지 호스트까지 잘 전달되게끔 로컬 포워딩, 라우터별 포워딩을 대응시키는 것이다.

## 포워딩과 라우팅: 데이터 평면과 제어 평면

- 포워딩(전달)
  패킷이 라우터의 입력 링크에 도달했을 때 라우터는 그 패킷을 적절한 출력 링크로 이동시켜야 한다.
  매우 짧은 시간(나노초, 10^-9초)단위를 가지고 있어 대표적으로 하드웨어에서 실행된다.
- 라우팅
  송신자가 수신자에게 패킷을 전송할 때 네트워크 계층은 패킷 경로를 결정해야 한다.
  이런 경로 계산하는 알고리즘을 `라우팅 알고리즘`이라고 한다.
  네트워크 전반에 걸쳐 출발지에서 목적지까지 데이터그램의 종단 간 경로를 결정한다.
  보통 초 단위를 갖고 있어 소프트웨어에서 보통 실행된다.

네트워크 라우터에서 필수 불가결한 요소는 `포워딩 테이블`이다.(4.2절에서 다룸)

- 라우터는 도착하는 패킷 헤더의 필드값을 조사하여 패킷을 전달한다.
  이 값을 라우터의 포워딩 테이블의 내부 색인으로 사용한다.
- 포워딩 테이블 엔트리에 저장된 헤더의 값은 해당 패킷의 전달되어야 할 라우터의 외부 링크 인터페이스를 나타낸다.
  헤더의 값은 패킷의 목적지 주소이거나 패킷이 속한 연결의 지시일 수 있다.

![Untitled](https://user-images.githubusercontent.com/76640167/212542030-df6ba632-c5a2-4460-959e-347960dd256f.png)

### 제어 평면: 전통적인 접근 방법

라우팅 알고리즘은 각각의 모든 라우터에서 실행되며, 라우터는 포워딩과 라우팅 기능을 모두 갖고 있어야 한다.

또한, 한 라우터의 라우팅 알고리즘 기능은 다른 라우터의 라우팅 알고리즘과 소통하며 포워딩 테이블의 값을 계산한다.

이러한 소통은 라우팅 프로토콜에 따라 라우팅 정보에 포함된 라우팅 메시지를 교환하며 이루어진다.

(5.2 ~ 5.4)

### 제어 평면: SDN 접근 방볍

위 그림과 같은 접근 방법은 지금까지 지속적으로 채택되어 왔다.

![Untitled](https://user-images.githubusercontent.com/76640167/212543852-6720ef7e-0ff9-46f5-bdf3-1771335eaca5.png)

위 그림은 물리적으로 분리된 원격 컨트롤러 컴퓨터와 각각의 라우터에 의해 사용될 포워딩 테이블을 분배하는 다른 접근법을 보여준다.

원격 컨트롤러가 높은 신뢰성과 중복성을 갖춘 원격 데이터 센터에 설치될 수 있으며, ISP 혹은 제3자에 의해 관리될 수 있다.

포워딩 테이블과 그 밖의 라우팅 정보를 포함한 메시지를 교환함으로써 소통할 수 있다.

위 그림과 같은 접근 방법은 SDN의 중심이다.

네트워크가 ‘소프트웨어적으로 정의되었을 때’, 포워딩 테이블을 계산하는 컨트롤러는 라우터와 상호작용을 하며 소프트웨어에서 실행되기 때문이다.

(SDN 제어 평면은 5.5에서…)

## 네트워크 서비스 모델

네트워크 서비스 모델은 송수신 호스트 간 패킷 전송 특성을 정의한다.

네트워크 계층에서 제공할 수 있는 서비스들을 살펴보면

- 보장된 전달
  패킷이 출발지 호스트에서 목적지 호스트까지 도착하는 것을 보장한다.
- 지연 제한 이내의 보장된 전달
  패킷의 전달 보장뿐만 아니라 호스트 간의 특정 지연 제한 안에 전달한다.
- 순서화 패킷 전달
  패킷이 목적지에 송신된 순서대로 도착하는 것을 보장한다.
- 최소 대역폭 보장
  송신과 수신 호스트 사이에 특정한 비트율의 전송 링크를 에뮬레이트(모방) 한다.
  송신 호스트가 비트들을 특정한 비트율 이하로 전송하는 한, 모든 패킷이 목적지 호스트까지 전달된다.
- 보안 서비스
  네트워크 계층은 모든 데이터그램을 출발지 호스트에서는 암호화, 목적지 호스트에서는 해독을 할 수 있게 하여 트랜스포트 계층의 모든 세그먼트에 대해 기밀성을 유지해야 한다.

인터넷 네트워크 계층은 최선형 서비스라고 알려진 서비스를 제공한다.

최선형 서비스는 다음과 같은 기능을 한다.

- 순서대로 수신됨을 보장하지 않음
- 목적지까지의 전송 자체도 보장하지 않음
- 종단 시스템 간 지연 또한 보장하지 않음
- 보장된 최소 대역폭 없음

이렇게 보면 쓸모없어 보이겠지만, 놀라운 범위의 애플리케이션을 가능하게 할 만큼 ‘충분히 좋다’고 입증되었다.
